/*---------------------------------------------------------------------------------


	bitmap demo with less than 256 tiles
	-- alekmaul


---------------------------------------------------------------------------------*/
#include "f18atest.h"

#include "gfxs.h"									// to add definition of graphics

//---------------------------------------------------------------------------------
const u8 default_palettes[]={
	0x00,0x00,0x09,0x00,0x0C,0x00,0x0F,0x00,0x00,0x3C,0x06,0x0F,0x09,0x3F,0x09,0x7D,0x00,0x00,0x00,0x69,0x09,0x90,0x0E,0xC3,0x02,0xA3,0x0C,0x5B,0x0C,0xCC,0x0F,0xFF,
	0x00,0x00,0x00,0x00,0x02,0xC4,0x06,0xD7,0x05,0x5E,0x07,0x7F,0x0C,0x55,0x04,0xEE,0x00,0x00,0x03,0x33,0x06,0x66,0x09,0x99,0x0C,0xCC,0x06,0x6F,0x09,0x9F,0x0F,0xFF,
	0x0C,0xEF,0x03,0x33,0x02,0x92,0x06,0xB2,0x0C,0xCC,0x07,0xAC,0x0F,0x95,0x0F,0xC9,0x0C,0xCC,0x00,0x6C,0x0C,0x00,0x00,0x90,0x06,0x90,0x09,0xC0,0x00,0x96,0x09,0xF0,
	0x00,0x00,0x0F,0xFF,0x02,0x22,0x04,0x44,0x06,0xCB,0x01,0x33,0x01,0x11,0x00,0x00,0x00,0x00,0x09,0x00,0x0C,0x00,0x0F,0x30,0x0F,0x60,0x0F,0xC3,0x00,0x69,0x0F,0xFF,
};

//---------------------------------------------------------------------------------
// The NMI routine. Gets called 50 or 60 times per second 
// nothing to update for bitmap example
void nmi (void) {
}

//---------------------------------------------------------------------------------
void main (void) {
	// Check if f18a is available
	vdp_f18ainit();

	// display a message regarding result of test
	if (vdp_f18aok==1) {
		// put screen in mode 1 Enhanced color mode 2 adapted for f18a
		vdp_f18asetmode1ecm3();
		//vdp_f18asetpalette(default_palettes,64);
		
		// Put default char in VRAM and duplicate to all areas
		//  as we are going to write to line 10, it is in the second area
		vdp_setdefaultchar(FNTNORMAL);
		vdp_duplicatevram();
		vdp_fillvram(0x2000,0x80,128*8); 	// Set Prio, Pal 0 
		vdp_enablescr();
	
		// Print text as we are not going to do something else
		vdp_putstring(8,5,"F18A SUPPORT OK !");
	}
	else {
		// Put screen in text mode 2
		vdp_setmode2txt();
	
		// Put default char in VRAM and duplicate to all areas
		//  as we are going to write to line 10, it is in the second area
		vdp_setdefaultchar(FNTNORMAL);
		vdp_duplicatevram();
		vdp_fillvram(0x2000,0xf1,128*8); 	// Change color (or we will see nothing)
		vdp_enablescr();
	
		// Print text as we are not going to do something else
		vdp_putstring(8,5,"NO F18A SUPPORT...");
	}

	// Wait for nothing :P
	while(1) {
		// Wait Vblank
		vdp_waitvblank(1);
	}
	// startup module will issue a soft reboot if it comes here 
}
